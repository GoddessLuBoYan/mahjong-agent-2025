# 主番向听计算器

包括主流番种与通用听法的向听数计算器

    原理：
    
    对于大部分主番（番数不小于4，不考虑不求人、胡绝张、杠牌系列、海底系列等特殊情况），使用打表遍历计算。一次耗时约0.2秒，遍历100w个听牌组合进行计算。

    对于七对、碰碰和等可能性过多，无法打表计算的特殊主流番种，使用特殊规则计算

    对于通用基本胡法，使用类似官方向听计算的方法进行计算，但考虑当前牌局剩余张数

使用方法：

```bash
# 生成主流番种的所有听牌组合
python wanted_utils_generator.py

# 对上面生成的听牌组合进行过滤，过滤非法情况
python packs_filter.py

# 使用最简单的faiss强制遍历计算，计算向听数
python wanted_utils.py

# 对于基本通用胡法，计算向听数
python xianten_utils.py

# 对于基本通用胡法，编译c++版本以提高效率（建议处理数据时使用c++版本，线上运行时使用python版本，维护成本最低）
python setup.py build_ext --inplace 

# 其它使用方法请参考wanted_utils.py
```

特别注意：

    组合龙+全不靠 12+12=24番的牌型组合被本代码赋予一个新的番种名称“组合不靠”，对标“七星不靠”，从而降低代码维护复杂度

    目前单次运行耗时0.2秒，需要遍历100w种牌型组合。如果能够使用bitset+dfs/bfs的话……